(()=>{"use strict";function t(){const t=document.querySelector(".todo"),e=document.querySelector(".in-progress"),n=document.querySelector(".done"),s=[];for(const e of t.querySelectorAll(".task-content"))s.push(e.textContent);localStorage.todo=JSON.stringify(s);const o=[];for(const t of e.querySelectorAll(".task-content"))o.push(t.textContent);localStorage.inProgress=JSON.stringify(o);const a=[];for(const t of n.querySelectorAll(".task-content"))a.push(t.textContent);localStorage.done=JSON.stringify(a)}(new class{init(){document.body.innerHTML="<div class=\"container\">\n      <div class='column'>\n        <h3 class='title'>Todo</h3>\n        <button class='button-add'>+ Add another card</button>\n        <ul class='items todo'></ul>\n      </div>\n      <div class='column'>\n        <h3 class='title'>In progress</h3>\n        <button class='button-add'>+ Add another card</button>\n        <ul class='items in-progress'></ul>\n      </div>\n      <div class='column'>\n        <h3 class='title'>Done</h3>\n        <button class='button-add'>+ Add another card</button>\n        <ul class='items done'></ul>\n      </div>\n    </div>",this.addContent(),this.container=document.querySelector(".container"),this.container.addEventListener("click",this.addTask.bind(this)),this.container.addEventListener("click",this.closeTask.bind(this)),this.container.addEventListener("click",this.deleteTask.bind(this)),this.container.addEventListener("mousedown",(t=>this.dragDown(t))),this.container.addEventListener("mousemove",(t=>this.dragMove(t))),this.container.addEventListener("mouseleave",(t=>this.dragLeave(t))),this.container.addEventListener("mouseup",(t=>this.dragUp(t)))}addContent(){this.btn=document.querySelectorAll(".button-add"),this.btn.forEach((t=>{t.addEventListener("click",(()=>{t.parentElement.insertAdjacentHTML("beforeend","\n<div class='content'>\n  <form class='form-area'>\n  <textarea class='form-text' placeholder='---'></textarea>\n  </form>\n  <div class='content-button'>\n  <button class='content-button-add'>add</button>\n  <button class='content-button-close'>✖</button>\n  </div>\n</div>\n")}))}))}addTask(e){if(e.preventDefault(),e.target.classList.contains("content-button-add")){this.column=e.target.parentElement.closest(".column");const n=this.column.querySelector("ul"),s=`\n<li class='items-item task'>\n<span class='task-content'>${this.column.querySelector(".form-text").value}</span>\n<button class="task-del">✖</button>\n</li`;n.insertAdjacentHTML("beforeend",s),t()}}closeTask(t){t.preventDefault(),t.target.classList.contains("content-button-close")&&(this.content=t.target.parentElement.closest(".content"),this.content.remove())}deleteTask(e){e.preventDefault(),e.target.classList.contains("task-del")&&(this.items=e.target.parentElement.closest(".items-item"),this.items.remove(),t())}dragDown(t){if(t.target.classList.contains("task-del"))return;const e=t.target.closest(".task");if(!e)return;t.preventDefault(),document.body.style.cursor="grabbing",this.dropEl=e.cloneNode(!0);const{width:n,height:s,left:o,top:a}=e.getBoundingClientRect();this.coordX=t.clientX-o,this.coordY=t.clientY-a,this.dropEl.classList.add("dragged"),this.dropEl.style.width=`${n}px`,this.dropEl.style.height=`${s}px`,document.body.appendChild(this.dropEl),this.dropEl.style.top=`${a}px`,this.dropEl.style.left=`${o}px`,this.dragEl=e}dragMove(t){t.preventDefault(),this.dropEl&&(document.body.style.cursor="grabbing",this.dropEl.style.left=t.pageX-this.coordX+"px",this.dropEl.style.top=t.pageY-this.coordY+"px")}dragLeave(){this.dropEl&&(this.dropEl.remove(),this.dropEl=null,this.dragEl=null)}dragUp(e){if(!this.dragEl)return;e.preventDefault(),document.body.style.cursor="auto";const n=document.elementFromPoint(e.clientX,e.clientY).closest(".task"),s=e.target.closest(".column").querySelector(".items");s?(s.appendChild(this.dragEl,n),t(),this.dropEl.remove(),this.dropEl=null):this.dropEl.remove()}}).init(),window.addEventListener("load",(function(){if(0===localStorage.length)return;const t=document.querySelector(".todo"),e=document.querySelector(".in-progress"),n=document.querySelector(".done"),s=JSON.parse(localStorage.todo),o=JSON.parse(localStorage.inProgress),a=JSON.parse(localStorage.done);for(let e=0;e<s.length;e+=1){const n=s[e],o=document.createElement("li");o.classList.add("items-item"),o.classList.add("task");const a=document.createElement("span");a.classList.add("task-content"),a.textContent=n;const l=document.createElement("button");l.classList.add("task-del"),l.textContent="✖",o.insertAdjacentElement("afterbegin",a),o.insertAdjacentElement("afterbegin",l),t.appendChild(o)}for(let t=0;t<o.length;t+=1){const n=o[t],s=document.createElement("li");s.classList.add("items-item"),s.classList.add("task");const a=document.createElement("span");a.classList.add("task-content"),a.textContent=n;const l=document.createElement("button");l.classList.add("task-del"),l.textContent="✖",s.insertAdjacentElement("afterbegin",a),s.insertAdjacentElement("afterbegin",l),e.appendChild(s)}for(let t=0;t<a.length;t+=1){const e=a[t],s=document.createElement("li");s.classList.add("items-item"),s.classList.add("task");const o=document.createElement("span");o.classList.add("task-content"),o.textContent=e;const l=document.createElement("button");l.classList.add("task-del"),l.textContent="✖",s.insertAdjacentElement("afterbegin",o),s.insertAdjacentElement("afterbegin",l),n.appendChild(s)}}))})();